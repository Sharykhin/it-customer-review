FROM golang:1.9

ENV APP_ENV prod
ENV MYSQL_ADDRESS "test:test@tcp(localhost:3306)/test?parseTime=true"

ADD . /go/src/github.com/Sharykhin/it-customer-review

WORKDIR /go/src/github.com/Sharykhin/it-customer-review

RUN go get . && \
    go get github.com/mattes/migrate && \
    go get gopkg.in/testfixtures.v2 && \
    go install github.com/Sharykhin/it-customer-review && \
    go get -u github.com/pressly/goose/cmd/goose

EXPOSE 8080

ENTRYPOINT /go/bin/it-customer-review
